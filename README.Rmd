---
output: github_document
---

# TimeCycle <img src="man/figures/logo.png" align="right"/>

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/",
  out.width = "100%"
)
library(TimeCycle)
suppressMessages(library(tidyverse))
```

<!-- badges: start -->
[![Lifecycle: maturing](https://img.shields.io/badge/lifecycle-maturing-blue.svg)](https://www.tidyverse.org/lifecycle/#maturing)
[![CRAN Status](https://www.r-pkg.org/badges/version/TimeCycle)](https://cran.r-project.org/package=TimeCycle)
[![R build status](https://github.com/r-lib/pkgdown/workflows/R-CMD-check/badge.svg)](https://github.com/r-lib/pkgdown/actions)
[![R build status](https://github.com/nesscoder/TimeCycle/workflows/R-CMD-check/badge.svg)](https://github.com/nesscoder/TimeCycle/actions)
<!-- badges: end -->

> TimeCycle is designed to ...

## Installation

```r
# Install release version from CRAN
install.packages("TimeCycle")

# Install development version from GitHub
devtools::install_github("nesscoder/TimeCycle")
```

## Usage

This is a basic example which shows you how to solve a common problem: See Reference\>zhang2014 For additional info on dataset. Set the replicate labels.

```{r, echo=F, include = FALSE}
suppressMessages(TimeCycle(data = zhang2014[1:3,], repLabel = rep(1,24), period = 24, experiments = 10))
```

```{r}
library(TimeCycle)

#set seed for reproducibility with random variables in example usage
set.seed(1234) 

TimeCycleResults <- TimeCycle(data = zhang2014, repLabel = rep(1,24), period = 24)
```

Check the output and filter for the genes of interest. In this case we are looking for genes with a period of oscillation between 22 and 26 hours and an FDR $< 0.05$.

```{r}
library(tidyverse)

TimeCycleResults %>%
  filter(22 < Period.in.Hours & Period.in.Hours < 26) %>%
  filter(pVals.adj < 0.05) %>%
  summarize(n())
```

 Read `vignette("TimeCycle")` for more details and to learn how to customise parameters for your time-series data set.
