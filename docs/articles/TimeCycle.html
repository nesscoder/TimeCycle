<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TimeCycle - Theory and Usage • TimeCycle</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TimeCycle - Theory and Usage">
<meta property="og:description" content="TimeCycle">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TimeCycle</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/TimeCycle.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Releases</li>
    <li class="dropdown-header">Version 1.0.0</li>
    <li class="divider">
    <li>
      <a href="../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nesscoder/TimeCycle/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="TimeCycle_files/header-attrs-2.4/header-attrs.js"></script><link href="TimeCycle_files/vembedr-0.1.3.9003/css/vembedr.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TimeCycle - Theory and Usage</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nesscoder/TimeCycle/blob/master/vignettes/TimeCycle.Rmd"><code>vignettes/TimeCycle.Rmd</code></a></small>
      <div class="hidden name"><code>TimeCycle.Rmd</code></div>

    </div>

    
    
<style>
p.caption{
  font-size: 2.5em;
}

h5 {
  text-align: center;
}
</style>
<p><img src="../man/figures/logo.png" width="175" align="right"></p>
<blockquote>
<p>The following vignette describes the theory and usage of TimeCycle.</p>
</blockquote>
<ul>
<li><p>For a comprehensive analysis and discussion of TimeCycle’s performance in detecting rhythmic genes, see the accompanying <a href="INSERT%20PAPER%20LINK">paper</a>.</p></li>
<li><p>For details pertaining to the data and source code used in the analysis, see the <a href="https://github.com/nesscoder/TimeCycle-data"><code>nesscoder/TimeCycle-data</code></a> git repository.</p></li>
</ul>
<hr>
<hr>
<div id="video-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#video-overview" class="anchor"></a><strong>Video Overview</strong>
</h2>
<div class="vembedr embed-responsive embed-responsive-16by9">
<div>
<iframe class="vimeo-embed embed-responsive-item" src="https://player.vimeo.com/video/481714748" width="533" height="300" frameborder="0" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
</div>
</div>
<hr>
<hr>
</div>
<div id="theory" class="section level2">
<h2 class="hasAnchor">
<a href="#theory" class="anchor"></a><strong>Theory</strong>
</h2>
<div id="algorithm-design-overview" class="section level3">
<h3 class="hasAnchor">
<a href="#algorithm-design-overview" class="anchor"></a>Algorithm Design Overview</h3>
<div class="figure" style="text-align: center">
<img src="../man/figures/overview.png" alt=" " width="75%" style="border: 0px;"><p class="caption">
</p>
</div>
<p>TimeCycle was developed as a reference-free method to quantify and classify cycling from non-cycling expression patterns in transciptomic time-series data. The basic algorithm framework is divided into two independent analyses: cycle detection and parameter estimation. The cycle detection framework consists of a <a href="TimeCycle.html#pre-processing-and-normalization-for-computational-efficiency-1">rescaling/normalization step</a>, reconstruction of the state space via <a href="TimeCycle.html#3-d-time-delay-embedding">3-D time-delayed embedding</a>, <a href="TimeCycle.html#detrending-via-dimension-reduction-1">non-linear dimension reduction</a> to remove trends, quantification of the measure of circularity via <a href="TimeCycle.html#persistent-homology-1">persistent homology</a>, and comparison of that measure to a <a href="TimeCycle.html#the-null-distribution-1">bootstrapped null distribution</a> of resampled time-series to assess statistical significance. The period estimation framework consists of a preprocessing step (i.e. detrending and smoothing) followed by period, amplitude, and phase estimations via a <a href="TimeCycle.html#fft-period-estimation-1">Fourier transfrom</a> fitting procedure. A complete description pertaining to each step in the TimeCycle method is found below.</p>
<hr>
</div>
<div id="takens-theorem" class="section level3">
<h3 class="hasAnchor">
<a href="#takens-theorem" class="anchor"></a>Takens’ Theorem</h3>
<div class="figure" style="text-align: center">
<img src="../man/figures/takens.png" alt=" " width="50%" style="border: 0px;"><p class="caption">
</p>
</div>
<p>TimeCycle utilizes Takens’ Theorem — <a href="https://en.wikipedia.org/wiki/Dynamical_systems_theory">dynamical systems theory</a> — to deconvolve rhythmic signals from non-rhythmic signals. Takens’ theorem proves that all the information needed to reconstruct the state space of a multivariate dynamic system can be captured by the embedded time-series of a single variable (<a href="http://www.crcv.ucf.edu/gauss/info/Takens.pdf">Takens, 1981</a>). As a consequence of the this larger theory, it was shown that the dynamics of a periodic signal exhibit circular patterns in the embedded space.</p>
<ul>
<li><p>An embedded periodic function forms a circle.</p></li>
<li><p>An embedded non-periodic function forms a mass.</p></li>
</ul>
<p>We can exploit this property for cycling detection by quantifying the circularity of data in the time-delay embedded space.</p>
<hr>
</div>
<div id="d-time-delay-embedding" class="section level3">
<h3 class="hasAnchor">
<a href="#d-time-delay-embedding" class="anchor"></a>3-D Time-Delay Embedding</h3>
<div class="figure" style="text-align: center">
<img src="../man/figures/Embedding3D.gif" alt=" " width="50%" style="border: 0px;"><p class="caption">
</p>
</div>
<p>Takens’ Theorem asserts that to reconstruct the state space (<span class="math inline">\(S\)</span>) from a single time-series, define a lag constant <span class="math inline">\(T\)</span> to generate a vector of delayed coordinates and plot the signal in the embedded space against the delayed version of itself. TimeCycle uses a 3-D embedding to encapsulate more dynamical history and enable periodic and non-periodic components to be separated. Above we show the constructed manifold when setting the lag <span class="math inline">\(T = 3\)</span>.</p>
<p><span class="math display">\[
S=\begin{cases}
\color{blue}{\mathbf{x}}&amp;= f(t)\\
\mathbf{y}&amp;= f(t+T)\\
\color{orange}{\mathbf{z}}&amp;= f(t+2T)
\end{cases}
\]</span></p>
<p>While the theorem proves the dynamics of the systems are preserved in the state space, the choice of lag <span class="math inline">\(T\)</span> to optimally reconstruct the state space manifold is unknown; since the organization depends on the choice of lag relative to the sampling scheme. As a result, TimeCycle sweeps through a series of lagged time-delays — by default from <span class="math inline">\(T = 2\)</span> to <span class="math inline">\(T = 5\)</span> — and computes the degree of circularity across the generated manifolds. If a signal is truly rhythmic, on average the state space manifold across lags should still maintain circular dynamics.</p>
<hr>
</div>
<div id="detrending-via-dimension-reduction" class="section level3">
<h3 class="hasAnchor">
<a href="#detrending-via-dimension-reduction" class="anchor"></a>Detrending Via Dimension Reduction</h3>
<div class="figure" style="text-align: center">
<img src="../man/figures/dimreduction.png" alt=" " width="50%" style="border: 0px;"><p class="caption">
</p>
</div>
<p>An important part of cycle detection is detrending non-rhythmic artifacts, such as linear trends, from time-series. A common and logical approach is to fit a line to the time-series and subtract out the fit prior to cycle detection. While this removes linear trends, the detrending procedure introduces false positives, as previously non-rhythmic signals — e.g. sigmoidal and exponential — look rhythmic. TimeCycle uses the state space to detrend signals without introducing detrending artifacts. Rather then going straight to a 2-D embedding and preserving the trend in the state space manifold, TimeCycle opts to transformed the signal into a 3-D embedding and remove trending artifacts during the dimension reduction step prior to the persistence calculation. For example:</p>
<ul>
<li><p>Dampened and trending signals form spirals and helices in the embedded space</p></li>
<li><p>Non-LinearDimension Reduction — Laplacian Eigenmap — is used to articulate the underlying circular manifold.</p></li>
<li><p>As helices maintain a cyclic pattern at an adjusted point in space, the Laplacian Eigenmap preserves the local circular geometry of the 3-D helix in a 2-D space.</p></li>
<li><p>By removing the linear component, the circular (periodic) component is recovered.</p></li>
</ul>
<p>As non-rhythmic signals by definition do not form circular dynamics in the embedded space, the dimension reduction limits the introduction of false positives as previously observed in other methods.</p>
<hr>
</div>
<div id="persistent-homology" class="section level3">
<h3 class="hasAnchor">
<a href="#persistent-homology" class="anchor"></a>Persistent Homology</h3>
<div class="figure" style="text-align: center">
<img src="../man/figures/PSH.gif" alt="𝜖" width="50%" style="border: 0px;"><p class="caption">
𝜖
</p>
</div>
<p>Persistent homology is an algebraic way to measure shape invariant (i.e. components, holes, voids, and higher dimensional analogs) about a discrete set of points. The algorithmic outline can be described as follows:</p>
<p><strong>Goal:</strong></p>
<ul>
<li>Parameterize circularity of the embedded points by computing a persistence score (<span class="math inline">\(PS\)</span>).</li>
</ul>
<p><strong>Method:</strong></p>
<ul>
<li><p>From each point of the embedded signal, a circle of radius <span class="math inline">\(\epsilon\)</span> is incrementally grown</p></li>
<li><p>Connect points if they are at least a diameter <span class="math inline">\(2\epsilon\)</span> apart.</p></li>
<li><p>A topological cycle appears at some <span class="math inline">\(\epsilon_{birth}\)</span> and disappears at <span class="math inline">\(\epsilon_{death}\)</span>.</p></li>
<li><p><span class="math inline">\(PS = \epsilon_{death} - \epsilon_{birth}\)</span></p></li>
</ul>
<p>More circular embeddings have larger difference between events. As a consequence of Takens’ Theorem, periodic signals will have high persistence, while non-periodic signals have low persistence. This difference in persistence scores allows for a quatitatie classification of rhythmic and non-rhythmic signals.</p>
<hr>
</div>
<div id="the-null-distribution" class="section level3">
<h3 class="hasAnchor">
<a href="#the-null-distribution" class="anchor"></a>The Null Distribution</h3>
<p>A major issue with current non-parametric cycle detection methods are the use of unrealistic null distributions. Non-parametric methods bootstrap a null distribution by generating random time-series sampled from a Gaussian distribution. In practice, gene expression in the biological context are constrained by transcription and degradation rates, and thus an assumption of random-independent Gaussian noise is inappropriate as it allows for chance fluctuations outside the realm of biological possibility. TimeCycle bootstraps times-series from changes in gene expression between sampled time-points — modeling biological transcription and degradation constraints.</p>
<p><strong>Goal:</strong></p>
<ul>
<li>Generate Biologically relevant null distribution for hypothesis testing</li>
</ul>
<p><strong>Method:</strong></p>
<ul>
<li><p>Construct null distribution from resampling of observed data</p></li>
<li><p>Compute difference between consecutive time-points in observed data</p></li>
<li><p>Resample differences with replacement to form random time-series</p></li>
<li><p>Compare persistence between observed and resampled time-series</p></li>
</ul>
<p><strong>Significance Definition:</strong></p>
<ul>
<li>By random chance, how often will you see a gene cycling with a persistence — averaged across a range of frequency (i.e. lags) — as or more extreme than the observed gene’s persistence.</li>
</ul>
<hr>
</div>
<div id="pre-processing-and-normalization-for-computational-efficiency" class="section level3">
<h3 class="hasAnchor">
<a href="#pre-processing-and-normalization-for-computational-efficiency" class="anchor"></a>Pre-Processing and Normalization For Computational Efficiency</h3>
<p>As stated in the <a href="TimeCycle.html#algorithm-design-overview-1">algorithm design overview</a>, TimeCycle is divided into two independent analyses: Cycle detection and parameter estimation. In the cycle detection analysis, genes are mean center and scaled; removing variation as a result of expression. By scaling gene expression, the same null distribution can be used for significance testing across all genes — decreasing the computation load in comparison to the alternative of not scaling and needing to generate a null distribution for each gene. When performing the less computationally costly parameter estimation, the rescaling procedure is omitted to preserve amplitude measures.</p>
<hr>
</div>
<div id="fft-period-estimation" class="section level3">
<h3 class="hasAnchor">
<a href="#fft-period-estimation" class="anchor"></a>FFT Period Estimation</h3>
<div class="figure" style="text-align: center">
<img src="../man/figures/fft.png" alt=" " width="90%" style="border: 0px;"><p class="caption">
</p>
</div>
<p>As described above, parameter estimation is performed independent of the cycling detection analysis. Prior to estimation, signals are linearly detrended and smoothed via a moving average before computing the signal fit (<strong>Middle Panel -</strong> <span style="color: blue; ">blue</span> <strong>solid line</strong>) using the first three harmonics (<strong>Middle Panel -</strong> <span style="color: red; font-weight: bold;">red</span>, <span style="color: green; font-weight: bold;">green</span>, <strong>and</strong> <span style="color: blue; font-weight: bold;">blue</span> <strong>dashed lines</strong>) of the fast Fourier transform (FFT). The FFT fit is used to compute the amplitude, period, and phase of oscillation (<strong>Right Panel -</strong> <span style="color: green; font-weight: bold;">green</span>, <span style="color: grey; font-weight: bold;">grey</span>, <strong>and</strong> <span style="color: orange; font-weight: bold;">orange</span> <strong>lines</strong>, respectively). A reconstructed model for the oscillation using the parameter estimates (<strong>Right Panel -</strong> <span style="color: blue; font-weight: bold;">blue</span> <strong>solid line</strong>) is overlaid on the original signal in the right panel .</p>
<hr>
<hr>
</div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a><strong>Usage</strong>
</h2>
<div id="input" class="section level3">
<h3 class="hasAnchor">
<a href="#input" class="anchor"></a>Input Data Structure</h3>
<p>Keeping with convention of other cycling detection methods, TimeCycle takes as input a <code>data.frame</code> of <code>numeric</code> gene expression values over time (row = genes <em>x</em> col = ZT times).</p>
<ul>
<li><p>Specify the genes names in the row names</p></li>
<li><p>Specify the ZT in the column names</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit">

<span class="co"># Pseudo code</span>
<span class="co"># df = data.frame of expression values (genes x time point)</span>
<span class="co"># geneNames = a vector that holds the name of each gene</span>

<span class="va">ztTimes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">48</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"ZT_"</span>, <span class="va">ztTimes</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">geneNames</span></pre></div>
<p>A properly formatted <code>data.frame</code> should look as follows:</p>
<table class="table"><tbody>
<tr class="odd">
<td align="right"></td>
<td align="center"><strong>ZT_0</strong></td>
<td align="center"><strong>ZT_2</strong></td>
<td align="center">…</td>
<td align="center"><strong>ZT_46</strong></td>
<td align="center"><strong>ZT_48</strong></td>
</tr>
<tr class="even">
<td align="right"><strong>gene_1</strong></td>
<td align="center">1.0</td>
<td align="center">3.0</td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">4.0</td>
</tr>
<tr class="odd">
<td align="right"><strong>gene_2</strong></td>
<td align="center">4.0</td>
<td align="center">8.0</td>
<td align="center">…</td>
<td align="center">2.0</td>
<td align="center">1.0</td>
</tr>
<tr class="even">
<td align="right"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋱</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
</tr>
<tr class="odd">
<td align="right"><strong>gene_n-1</strong></td>
<td align="center">5.0</td>
<td align="center">8.0</td>
<td align="center">…</td>
<td align="center">3.0</td>
<td align="center">2.0</td>
</tr>
<tr class="even">
<td align="right"><strong>gene_n</strong></td>
<td align="center">9.0</td>
<td align="center">4.0</td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">3.0</td>
</tr>
</tbody></table>
<hr>
</div>
<div id="repLab" class="section level3">
<h3 class="hasAnchor">
<a href="#repLab" class="anchor"></a>Replicate Labels</h3>
<div id="even" class="section level4">
<h4 class="hasAnchor">
<a href="#even" class="anchor"></a>Even Replicates</h4>
<p>Following the convention above, the input <code>data.frame</code> should define the gene names and ZT times with replicate ZT times (i.e. R1, R2, …) placed next to each other.</p>
<p>A properly formatted <code>data.frame</code> with even replicates across all time-points should look as follows:</p>
<table class="table"><tbody>
<tr class="odd">
<td align="right"></td>
<td align="center">ZT_0_R1</td>
<td align="center">ZT_0_R2</td>
<td align="center"><strong><em>ZT_2_R1</em></strong></td>
<td align="center"><strong><em>ZT_2_R2</em></strong></td>
<td align="center">…</td>
<td align="center">ZT_46_R1</td>
<td align="center">ZT_46_R2</td>
<td align="center"><strong><em>ZT_48_R1</em></strong></td>
<td align="center"><strong><em>ZT_48_R2</em></strong></td>
</tr>
<tr class="even">
<td align="right"><strong>gene_1</strong></td>
<td align="center">1.0</td>
<td align="center">2</td>
<td align="center"><strong><em>3.0</em></strong></td>
<td align="center"><strong><em>2.0</em></strong></td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">9.0</td>
<td align="center"><strong><em>4.0</em></strong></td>
<td align="center"><strong><em>5.0</em></strong></td>
</tr>
<tr class="odd">
<td align="right"><strong>gene_2</strong></td>
<td align="center">4.0</td>
<td align="center">3</td>
<td align="center"><strong><em>8.0</em></strong></td>
<td align="center"><strong><em>9.0</em></strong></td>
<td align="center">…</td>
<td align="center">2.0</td>
<td align="center">1.0</td>
<td align="center"><strong><em>1.0</em></strong></td>
<td align="center"><strong><em>3.0</em></strong></td>
</tr>
<tr class="even">
<td align="right"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong><em>⋮</em></strong></td>
<td align="center"><strong><em>⋮</em></strong></td>
<td align="center"><strong>⋱</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong><em>⋮</em></strong></td>
<td align="center"><strong><em>⋮</em></strong></td>
</tr>
<tr class="odd">
<td align="right"><strong>gene_n-1</strong></td>
<td align="center">5.0</td>
<td align="center">6</td>
<td align="center"><strong><em>8.0</em></strong></td>
<td align="center"><strong><em>7.0</em></strong></td>
<td align="center">…</td>
<td align="center">3.0</td>
<td align="center">4.0</td>
<td align="center"><strong><em>2.0</em></strong></td>
<td align="center"><strong><em>1.0</em></strong></td>
</tr>
<tr class="even">
<td align="right"><strong>gene_n</strong></td>
<td align="center">9.0</td>
<td align="center">8.0</td>
<td align="center"><strong><em>4.0</em></strong></td>
<td align="center"><strong><em>5.0</em></strong></td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">8.0</td>
<td align="center"><strong><em>3.0</em></strong></td>
<td align="center"><strong><em>2.0</em></strong></td>
</tr>
</tbody></table>
<p><strong>Example Replicate Labels</strong></p>
<p>With even replicates, the <strong>number of replicates at each ZT time</strong> should be explicitly specified in a vector — e.g. a data set with 2 replicates at 24 different ZT times would have a replicate label vector of length 24, even through there are 48 samples total:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># Each ZT time point in the data.frame has 2 replicates</span>
<span class="va">replicateLabels_even</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">2</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">df_evenReplicates</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Run TimeCycle with default setting</span>
<span class="fu"><a href="../reference/TimeCycle.html">TimeCycle</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_evenReplicates</span>, repLab <span class="op">=</span> <span class="va">replicateLabels_even</span><span class="op">)</span></pre></div>
<p>In the case of <code><a href="../reference/zhang2014.html">zhang2014()</a></code> example data set — sampled every 2 hours for 48 hours (i.e. 24 ZT times) — there is only 1 sample per time point. As a result, the replicate label would have 1 sample for all 24 time points: <code>replicateLabel &lt;- rep(x = 1, times = ncol(zhang2014))</code>.</p>
<hr>
</div>
<div id="uneven" class="section level4">
<h4 class="hasAnchor">
<a href="#uneven" class="anchor"></a>Uneven Replicates</h4>
<p>Following the convention above, the input <code>data.frame</code> should define the gene names and ZT times with replicate ZT times (i.e. R1, R2, …) placed next to each other.</p>
<p>A properly formatted <code>data.frame</code> with uneven replicates across all time-points should look as follows:</p>
<table class="table"><tbody>
<tr class="odd">
<td align="right"></td>
<td align="center">ZT_0_R1</td>
<td align="center">ZT_0_R2</td>
<td align="center">ZT_0_R3</td>
<td align="center"><strong><em>ZT_2_R1</em></strong></td>
<td align="center">…</td>
<td align="center">ZT_46_R1</td>
<td align="center">ZT_46_R2</td>
<td align="center"><strong><em>ZT_48_R1</em></strong></td>
<td align="center"><strong><em>ZT_48_R2</em></strong></td>
</tr>
<tr class="even">
<td align="right"><strong>gene_1</strong></td>
<td align="center">1.0</td>
<td align="center">2.0</td>
<td align="center">1.0</td>
<td align="center"><strong><em>3.0</em></strong></td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">9.0</td>
<td align="center"><strong><em>4.0</em></strong></td>
<td align="center"><strong><em>5.0</em></strong></td>
</tr>
<tr class="odd">
<td align="right"><strong>gene_2</strong></td>
<td align="center">4.0</td>
<td align="center">3.0</td>
<td align="center">5.0</td>
<td align="center"><strong><em>8.0</em></strong></td>
<td align="center">…</td>
<td align="center">1.0</td>
<td align="center">1.0</td>
<td align="center"><strong><em>1.0</em></strong></td>
<td align="center"><strong><em>3.0</em></strong></td>
</tr>
<tr class="even">
<td align="right"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong><em>⋮</em></strong></td>
<td align="center"><strong>⋱</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong><em>⋮</em></strong></td>
<td align="center"><strong><em>⋮</em></strong></td>
</tr>
<tr class="odd">
<td align="right"><strong>gene_n-1</strong></td>
<td align="center">5.0</td>
<td align="center">6.0</td>
<td align="center">4.0</td>
<td align="center"><strong><em>8.0</em></strong></td>
<td align="center">…</td>
<td align="center">3.0</td>
<td align="center">4.0</td>
<td align="center"><strong><em>2.0</em></strong></td>
<td align="center"><strong><em>1.0</em></strong></td>
</tr>
<tr class="even">
<td align="right"><strong>gene_n</strong></td>
<td align="center">9.0</td>
<td align="center">8.0</td>
<td align="center">9.0</td>
<td align="center"><strong><em>4.0</em></strong></td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">8.0</td>
<td align="center"><strong><em>3.0</em></strong></td>
<td align="center"><strong><em>2.0</em></strong></td>
</tr>
</tbody></table>
<p><strong>Example Replicate Labels</strong></p>
<p>With uneven replicates,the <strong>number of replicates at each ZT time</strong> should be explicitly specified in a vector — e.g. a data set with 24 different ZT times would have a replicate label vector of length 24, even through there may be more than 24 samples total. Do <strong>NOT</strong> include unsampled ZT time with 0 replicates.</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co"># Pseudo code for example data.frame above</span>
<span class="co"># Specify the number or replicates for each ZT time point in the data.frame</span>
<span class="co"># ... = replicate values at omited ZT times. Actual code must specify.</span>
<span class="va">replicateLabel_uneven</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="va">...</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">replicateLabel_uneven</span><span class="op">)</span>
<span class="co">#&gt; 24</span>

<span class="co"># Run TimeCycle with default setting</span>
<span class="fu"><a href="../reference/TimeCycle.html">TimeCycle</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_unevenReplicates</span>, repLab <span class="op">=</span> <span class="va">replicateLabels_uneven</span><span class="op">)</span></pre></div>
<hr>
</div>
</div>
<div id="missing-data" class="section level3">
<h3 class="hasAnchor">
<a href="#missing-data" class="anchor"></a>Missing Data</h3>
<p>Missing data should be labeled with an <code>NA</code>. Use the same convention as above for defining replicate labels for <code>data.frames</code> with <a href="#even">even</a> and <a href="#uneven">uneven</a> number of replicates.</p>
<p>A properly formatted <code>data.frame</code> with missing values should look as follows:</p>
<table class="table">
<thead><tr class="header">
<th align="right"></th>
<th align="center"><strong>ZT_0</strong></th>
<th align="center"><strong>ZT_2</strong></th>
<th align="center">…</th>
<th align="center"><strong>ZT_46</strong></th>
<th align="center"><strong>ZT_48</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right"><strong>gene_1</strong></td>
<td align="center">1.0</td>
<td align="center"><code>NA</code></td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">4.0</td>
</tr>
<tr class="even">
<td align="right"><strong>gene_2</strong></td>
<td align="center">4.0</td>
<td align="center">8.0</td>
<td align="center">…</td>
<td align="center"><code>NA</code></td>
<td align="center">1.0</td>
</tr>
<tr class="odd">
<td align="right"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋱</strong></td>
<td align="center"><strong>⋮</strong></td>
<td align="center"><strong>⋮</strong></td>
</tr>
<tr class="even">
<td align="right"><strong>gene_n-1</strong></td>
<td align="center">5.0</td>
<td align="center">8.0</td>
<td align="center">…</td>
<td align="center"><code>NA</code></td>
<td align="center">2.0</td>
</tr>
<tr class="odd">
<td align="right"><strong>gene_n</strong></td>
<td align="center"><code>NA</code></td>
<td align="center">4.0</td>
<td align="center">…</td>
<td align="center">7.0</td>
<td align="center">3.0</td>
</tr>
</tbody>
</table>
<hr>
</div>
<div id="parameter-selection" class="section level3">
<h3 class="hasAnchor">
<a href="#parameter-selection" class="anchor"></a>Parameter Selection</h3>
<p>The main TimeCycle function’s parameters are defined by default for the minimal recommended sampling scheme of every 2-h for 48-h (<a href="https://doi.org/10.1177/0748730417728663">Hughes et al., 2017</a>; <a href="https://doi.org/10.1371/journal.pcbi.1007666">Laloum &amp; Robinson-Rechavi, 2020</a>; <a href="https://doi.org/10.1177%2F0748730420934672">Ness-Cohn et al., 2020</a>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu"><a href="../reference/TimeCycle.html">TimeCycle</a></span><span class="op">(</span>
  <span class="va">data</span>,
  <span class="va">repLabel</span>, 
  resamplings <span class="op">=</span> <span class="fl">10000</span>,
  minLag <span class="op">=</span> <span class="fl">2</span>,
  maxLag <span class="op">=</span> <span class="fl">5</span>,
  period <span class="op">=</span> <span class="fl">24</span>,
  cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>,
  laplacian <span class="op">=</span> <span class="cn">T</span>,
  linearTrend <span class="op">=</span> <span class="cn">F</span>
<span class="op">)</span></pre></div>
<p>For defining the <code>data</code> and <code>repLabel</code> inputs, see <a href="#input">Input Data Structure</a> and <a href="#repLab">Replicate Labels</a> section above. The <strong>default parameters are recommended</strong> for all sampling schemes that meet the minimal recommended sampling requirements.</p>
<p>For Time-series sampled:</p>
<ul>
<li><p><a href="#shortTS">under 48-h in length</a></p></li>
<li><p><a href="#sparseTS">less frequently than every 2-h</a></p></li>
</ul>
<p>we recommend setting <code>maxLag = 3</code>, rather than the default <code>maxLag = 5</code>. See sections below for details.</p>
<div id="warning-data-sets-sampled-under-the-minimal-recommended-sampling-scheme-of-every-2-h-for-48-h-have-been-shown-to-be-unreliable-across-cycling-detection-methods-hughes-et-al--2017-laloum-robinson-rechavi-2020-ness-cohn-et-al--2020-️" class="section level5">
<h5 class="hasAnchor">
<a href="#warning-data-sets-sampled-under-the-minimal-recommended-sampling-scheme-of-every-2-h-for-48-h-have-been-shown-to-be-unreliable-across-cycling-detection-methods-hughes-et-al--2017-laloum-robinson-rechavi-2020-ness-cohn-et-al--2020-%EF%B8%8F" class="anchor"></a>⚠️ Warning: Data sets sampled under the minimal recommended sampling scheme of every 2-h for 48-h have been shown to be unreliable across cycling detection methods (<a href="https://doi.org/10.1177/0748730417728663">Hughes et al., 2017</a>; <a href="https://doi.org/10.1371/journal.pcbi.1007666">Laloum &amp; Robinson-Rechavi, 2020</a>; <a href="https://doi.org/10.1177%2F0748730420934672">Ness-Cohn et al., 2020</a>) ⚠️</h5>
<hr>
</div>
<div id="shortTS" class="section level4">
<h4 class="hasAnchor">
<a href="#shortTS" class="anchor"></a>Short Time-Series</h4>
<p>While we do <strong>NOT</strong> recommend using a sampling scheme less than 48-h in length; for these data sets use <code>maxLag = 3</code>, rather than the default <code>maxLag = 5</code>. Furthermore, TimeCycle requires a minimum of 18 time points for cycling detection — ie. a sampling scheme of every 2-h for 36-h.</p>
<p>Often researchers elect to use a 24-h sampling scheme; however circadian cycling detection methods have been shown to be unreliable at this sampling length — i.e. a lack of reproducibility. The lack of reproducibility comes from the fact that the sampling scheme is inherently under-sampled for determining a circadian rhythm — a cycle that <strong>repeats</strong> with a 24-h period. Methods that use a curve fitting procedure classify a gene as cycling or not, depending on if the 24-h of data match up with the dynamics of the reference curve (i.e. sin wave). Nonetheless, classifying this signal as circadian is illogical, as there is no information as to what happens to a gene in the <strong>next</strong> 24-h — if it repeats the cycle or has some other dynamics. When this data is processed by TimeCycle, this lack of information presents itself in the inability to reconstruct a cycle in the embedded space — thus all genes are classifies as non-cycling. This logically makes sense since we do not have enough information to know what happens to the signal after the first 24-h period and thus by definition cannot call a gene circadian or not. See TimeCycle’s supplement for details.</p>
<p>At the 36-h every 2-h minimum, we now have information pertaining to 1.5 cycles — enough to at least make a prediction about the signal dynamics in the next 24-h window. Users may still see decreased performance in detection of non-symmetric cyclers. Nonetheless, strong symmetric cyclers and know circadin genes can still be detected at 36-h. See TimeCycle paper for details.</p>
<hr>
</div>
<div id="sparseTS" class="section level4">
<h4 class="hasAnchor">
<a href="#sparseTS" class="anchor"></a>Sparsely Sampled Data</h4>
<p>While we do <strong>NOT</strong> recommend using a sampling interval less frequent than every 2-h; for these data sets use <code>maxLag = 3</code>, rather than the default <code>maxLag = 5</code>. Note that circadian cycling detection methods, as well as TimeCycle, have been shown to be unreliable at 4-h intervals and above — i.e. lack of reproducibility with high false positives rates (<a href="https://doi.org/10.1177/0748730417728663">Hughes et al., 2017</a>; <a href="https://doi.org/10.1177%2F0748730420934672">Ness-Cohn et al., 2020</a>)</p>
<p>The depreciation in TimeCycle’s performance is attributed to a sparsely-sampled manifolds in the state space, potentially resulting in an insufficient number of data-points for cycle formation. At higher lags, more points are removed from the embedded manifold, thus by setting the <code>maxLag = 3</code>, we decrease the chances of having an insufficient number of data-points for cycle formation.</p>
<hr>
</div>
<div id="prioritize-detection-of-linear-trending-signals" class="section level4">
<h4 class="hasAnchor">
<a href="#prioritize-detection-of-linear-trending-signals" class="anchor"></a>Prioritize Detection of Linear Trending Signals</h4>
<div id="warning-setting-lineartrend-t-may-increase-false-positive-rates---not-recommended---use-with-caution-️" class="section level5">
<h5 class="hasAnchor">
<a href="#warning-setting-lineartrend-t-may-increase-false-positive-rates---not-recommended---use-with-caution-%EF%B8%8F" class="anchor"></a>⚠️ Warning: Setting <code>linearTrend = T</code> may increase false positive rates - Not Recommended - Use with Caution ⚠️</h5>
<p>TimeCycle has been shown to have decreased performance in detecting linear trending signals for time-series sampled longer than 48-h. As time-series sampling is extended, linear and damped oscillatory trends become more pronounced — dominating the underlying signal and hindering <a href="TimeCycle.html#detrending-via-dimension-reduction-1">detrending</a> in the state space. Excluding trending signals can be (un)desirable depending on the oscillatory patterns of interest in the context of the biological question being asked.</p>
<p>To prioritize the detection of linear trending signals with TimeCycle, set the <code>linearTrend = T</code>.</p>
<p>In this case, TimeCycle processes the derivative the autocorrelation function before preforming the topological analysis. This process removes the linear trend, while persevering the oscillatory dynamics.</p>
<p>While this preprocessing step improves the detection of linear trending oscillations, the process introduces the risk of false positives, as previously non-rhythmic signals may look rhythmic — similar to the short coming of other cycling detection methods. If proceeding wih this parameter selection, we recommend checking the genes detected as cycling — as this process will detect sigmoidal waveforms that shift at the 24 hour mark as cycling.</p>
<hr>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://sites.northwestern.edu/elannesscohn/">Elan Ness-Cohn</a>, <a href="https://sites.northwestern.edu/braunlab/">Rosemary Braun</a>, <a href="https://www.quantitativebiology.northwestern.edu/"><img src="https://nesscoder.github.io/TimeCycle/QBio.png" height="40"></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
